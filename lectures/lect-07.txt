Fundamentals of
Secure Software
Engineering
Winter term 2025/26
Code Review, Clean Code, Test Driven
Development
Dr. Sergej Dechand / Dr. Christian Tiefenau
ğŸ› Vulnerability of the Day âˆ’ Uncontrolled Format String âˆ’ OS Command Injection ğŸ‘€ Code Review âˆ’ Git push, git merge âˆ’ Variables ğŸ§¹ Clean Code âˆ’ Code smells âˆ’ Refactoring âˆ’ Antipatterns to avoid ğŸ”¬ Static Analysis
2
Outline today
https://www.adac.de/rund-ums-fahrzeug/autokatalog/marken-modelle/mazda/mazda-3/
+ =
+
VOTD | Can you guess?
3
Podcasts are Dangerous
4
VotD | Uncontrolled Format String
Uncontrolled Format Strings | Detailed
5
User input as format string â†’ memory read/write primitive
ğŸ› Problem
âˆ’ User-controlled input is passed directly as format
string to printf-family functions printf(str)
âˆ’ Attackers can use format specifiers (%x, %n) to read
memory or write arbitrary values
â€¢ %x prints hex, %n writes number of bytes printed so far
to address provided
ğŸ›¡ Mitigations
âˆ’ Set format string explicitly, e.g. printf("%s", str)
âˆ’ In cases where you cannot avoid loading format strings
from outside, use sanitization (best: whitelisting)
âˆ’ Compiler warnings: -Wformat-security
char *str = user_input;
printf(str);
// no arguments â†’ stack
// printf("%n", &a) prints addr
> %x.%x.%x.%x
< bffff7a0.0.252.804a008
// write AAAA into address
> AAAA%08x.%08x.%08x.%n
// Writes into address
ğŸ¯ Root problem
â€¢ Unsanitized input is forwarded to an OS command
â€¢ Similar to SQL injection and Path Traversal. Often,
string concatenation is used to issue commands
not anticipated by the programmer
ğŸ›¡ Mitigations
â€¢ Try restricting the OS call to a single command
â€¢ In Java, for instance, use ProcessBuilder API
â€¢ Generally avoid OS calls whenever possible
â€¢ Ideally restrict inputs to those command via a whitelist
ğŸ”— Also known as CWE-78: Improper Neutralization of
Special Elements used OS Command ('OS Command Injection')
6
OS Command Injection | Details
Shell metacharacters turn data into commands
// C - vulnerable
char cmd[256];
sprintf(cmd, "ping %s", inp);
system(cmd);
// Java - vulnerable
Runtime.getRuntime().exec("ping " + inp);
// Input: 8.8.8.8; rm -rf /
// Executes: ping 8.8.8.8; rm -rf /
VotD | OS Command Injection
7
OS Command Injection
8
Real-world Vulnerability
http://www.apacheweek.com/issues/02-03-22#security
CVE-2002-0061
9
Requirements
and Use Cases
Architecture
And Design Test Plans Code Test and
Test Results
Feedback from
the Field
Risk-Based
Security Tests
Code Review Security and
Penetration Testing
Security
Operations
External
Review
Risk Analysis
Security
Requirements
Abuse
Cases Risk Analysis
Code Reviews
10
Is this a code review?
Push Push Done
11
Shared understanding beats solo shipping
Why do Code Reviews at all?
12
Higher Complexity | What are the elements of Merge Requests?
Variables You Can Adjust in Code Reviews
â— Online / Offline
â— Pair / Group
â— Asynchronous / Synchronous
â— During Coding / After Coding
13
Find what works for your team and context
Best Practices
â— Size (less than 200 changes increases participation a lot)
â— Adherence to conventions
â— Constructive feedback, good communication
â— Prioritization
â— Generally: Make it easy for the others
14
15
ğŸ§¹ Clean Code
Letâ€™s talk about Code
16
17
Clean Code
â€¢ Clean Code is intuitively understandable
text
â€¢ Not necessarily code, can be YAML, DBs, etc..
â€¢ 80% of the life cycle of a project is
maintenance, feature expansion and bug
fixing.
â€¢Itâ€™s not easy and requires experience.
â€¢ This experience can be learned by doing.
18
â€¢ â€œWhat? How can code â€˜smellâ€™? - Well it doesnâ€™t have a noseâ€¦ but it
definitely can stink!â€ - refactoring.guru
â€¢ Code Smells are patterns that make code less readable.
Code Smells
19
Refactorings
â€¢We have dirty code, we want clean Code.
â€¢A refactoring is a structure changing, behaviour preserving process.
20
My Top 3 Antipatterns
â— Long Method
â¢ Extract Method
â— Improper Naming
â¢ Rename (duh)
â— Insufficient Encapsulation
â¢ Extract Method
â¢ Move Method
21
Security Impact
â— Increased readability and changeability should increase security, as
bugs can be easier to find and fix
â€¦ right?
â— Studies show code review improves quality and knowledge sharing,
but isolating the security impact specifically is hard to measure
â—‹ Industry consensus is strong though
â—‹ Very active field of research!
22
23
Test Driven Development
â— The idea of TDD is to convert requirements to test cases and force the
requirements to be fulfilled by writing the tests first.
â— Two approaches
âˆ’ Chicago / Detroit TDD (bottom up)
âˆ’ London TDD (top down)
24
Test Driven Development
â€¢Do not write more than necessary to
make the test pass
â€¢If you donâ€™t know what to implement
next, look at the user story
prioritization (what is the next most
important thing to do?)
â€¢ Plan ahead and break the tasks up if
necessary.
25
Process
Rules
1. Do not write production code that is more specific than the tests.
â€¢ Tests makes the test suite more specific.
â€¢ Production code makes the production app more general.
2. Donâ€™t go for the goal. Avoid the central behaviour as long as
possible.
3. Do not bring TDD to work if youâ€™re not good at TDD.
â€¢ Trying to improve code by writing tests is never wrong. Just donâ€™t force your
team until youâ€™re sure of what youâ€™re doing.
26
Effects
â— % Test coverage
â— If you break something, youâ€™ll know it.
â— More modular projects
â— Examples of how to use code snippets
â— These all should (in theory) result in faster development speed
later in the development cycle
27
When not to Use
â— If youâ€™re in a professional setting and youâ€™re not an expert.
â— If youâ€™re doing teamwork and youâ€™re not an expert.
â— Otherwise? Go for it.
28
When to Use
â— Small projects
â— Personal projects without a strict deadline
â— If the whole team are experts, every project
29
Security Impact
â— Functionality tests exist: Bugs are easier to fix
â— If done well, tests also function as code snippets on how to use your
functions, and API misuse may happen less
â— Some security requirements can be translated into tests
â—‹ Although you have to think about many edge cases
â— Some kind of bugs are never created in the first place
30
Exercises
â€¢ 2 Minute TDD
â€¢ Katas
â€¢ Program a calculator
â€¢ Program a calculator that uses strings (terms) as inputs
â€¢ A program that converts ints to roman numerals
â€¢ A program that converts roman numerals to ints
â€¢ Refactoring Katas
â€¢ Great to learn how to write tests in an existing code base without tests
31
Automated Security Reviews
32
Code Analysis
Challenge | Code Reviews do not Scale
ğŸ› Proactive Security Testing
âˆ’ Remember our test planning approach and the â€œbag of tricksâ€ in the bottom up?
âˆ’ Goal is to avoid as many mistakes as possible
âˆ’ Arenâ€™t there specific rules we could use for automation?
ğŸ‘€ Two main Approaches
âˆ’ Whitebox Analysis: Scan the source code for issues
âˆ’ Blackbox Analysis: Execute program and try to attack
33
34
Back to our example from the first lecture, can we find this one automatically
Challenge | Is this code secure?
ğŸ§¼ Input sanitization (deprecated, experts only)
ğŸ— Prepared Statements (recommended)
ğŸª² Injection Types
â€¢ Command line injections, NoSQL injections, etc
35 https://cwe.mitre.org/data/definitions/89.html
Protection requires Input Sanitization and Neutralization (CWE 89)
Can we check whether this was done correctly?
36
ğŸ”¬ Static Analysis
aka Static Application Security Testing (SAST)
Static Application Security Testing (SAST)
ğŸ“˜ Definition
Static Analysis Security Testing (SAST) analyses the code for problematic patterns without
executing the code. The goal is to avoid security issues and bad coding patterns.
âœ… What it finds
â—‹ Code Injections (unvalidated and unsanitized inputs)
â—‹ Usage of dangerous functions
â—‹ Hard-coded credentials
â—‹ â€¦
Use Cases
â—‹ Early in the SDLC, ideally in the IDE but also part of the build pipeline
â—‹ Typically on source code level, but some take Bytecode
37
Grammarly, but for security
Tools
â—‹ grep -n -A 2 "createQuery.*(" File.java | grep -B 3 "\+"
â—‹ Semgrep, Joern, CodeQL (Github / VSCode), SonarQube, IntelliJ, etc
38
Requirements
and Use Cases
Architecture
And Design Test Plans Code Test and
Test Results
Feedback from
the Field
Risk-Based
Security Tests
Code Review Security and
Penetration Testing
Security
Operations
External
Review
Risk Analysis
Security
Requirements
Abuse
Cases Static Analysis
Depending on the use case, part of code and testing strategy
Static Analysis
Outlook | How does Static Analysis Work
ğŸ“˜ How it Works
SAST translates the code into graph representations, e.g. Control Flow Graphs (CFGs).
Taint analysis then attempts to find bad and dangerous patterns
ğŸ§  Core Elements of Taint Analysis [1]
â— Sources: Input with potentially dangerous data (e.g., user inputs, HTTP parameters)
â— Sinks: Critical functions for successful attacks (e.g., SQL, OS Commands)
â— Propagation: Tracking tainted ("contaminated") data through the code
â— Sanitizer: Cleansing functions that remove the taint
39
Search in code graphs for bad patterns and perform taint analysis
[1]: Livshits et al. (2005): Finding security vulnerabilities in Java applications with static analysis. Proceedings of the 14th USENIX Security Symposium
[2]: Demystifying Taint Analysis in Semgrep as a simplified explanation
SAST | Limitations
40
False negatives lead to missed issues in the code (Missed the Fire)
public ResultSet findUserInsecure(String username) throws SQLException {
 Query q = new Query();
 String sql = q.getUserLookup(username);
 return DatabaseUtils.query(conn, sql);
}
class Query {
 public String getUserLookup(String user) {
 return "SELECT * FROM users WHERE username = '" + user + "'";
 }
}
class DatabaseUtils {
 public static ResultSet query(Connection conn, String sql) throws SQLException {
 return conn.createStatement().executeQuery(sql);
 }
}
SAST | Limitations
41
False positives where we show potential issues but these are benign (Crying Wolf)
public ResultSet findUserWithRealSanitize(String username) throws SQLException {
 String sanitized = username.replaceAll("[^a-zA-Z0-9]", ""); // Only allows alphanumeric
 String query = "SELECT * FROM users WHERE username = '" + sanitized + "'";
 return this.conn.createStatement().executeQuery(query);
}
SAST | Trade-Offs
42
The inevitable trade-off between false positives and false negatives
ğŸ“˜ Note
Each analysis tool balances false positives and false negatives. Depending on the tool, this is either
determined by the vendor or left to the user via configuration settings.
â†’ Many complex, undecidable, or unsolvable problems from theoretical computer science, such as Rice's
Theorem, the Halting Problem, etc. [1]
âš– Trade-Off Matrix
âš  False Positive ğŸ”¥ False Negative
Meaning Alert without a real error Vulnerability overlooked
Risk Desensitization / Loss of trust False sense of security
Economic Damage Requires effort Errors are found too late
Mnemonic Crying Wolf Missed the Fire
[1]: William Landi: Undecidability of static analysis (ACM Letters on Programming Languages and Systems)]
(https://doi.org/10.1145/161494.161501)
From Theory to Practice
43
Covered four key practices today
âˆ’ Code Reviews - catching issues through human insight
âˆ’ Clean Code - making code readable and maintainable
âˆ’ TDD: building quality in from the start
âˆ’ Static Analysis - automated security checking
Let's see how they work together...
Key Takeaways | Putting it all together (Simplified)
44
https://owasp.org/www-community/Source_Code_Analysis_Tools
https://owasp.org/www-community/controls/Static_Code_Analysis
Question
45
Does ChatGPT perform code analysis? Would it be static or dynamic?
46
â€¢ Brian Chess and Jacob West, Secure Programming with Static Analysis, Addison-Wesley, 2007.
â€¢ Michael Howard, â€œA Process for Performing Security Code Reviews.â€ IEEE Security & Privacy, July 2006.
â€¢ Eoin Keary et. al., OWASP Code Review Guide 1.1,
http://www.owasp.org/index.php/Category:OWASP_Code_Review_Project, 2008.
â€¢ Jason Cohen, Best Kept Secrets of Peer Code Review
http://smartbear.com/SmartBear/media/pdfs/best-kept-secrets-of-peer-code-review.pdf, 2006.
â€¢ IEEE Standard for Software Reviews and Audits," in IEEE Std 1028-2008 , Aug. 2008. DOI:
10.1109/IEEESTD.2008.4601584
â€¢ Khedker, Uday et al., Data flow analysis: theory and practice, 2009
47
References & Further Readings